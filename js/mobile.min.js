var mobile=mobile||{};mobile.panelHead=jQuery("#panel-head"),mobile.panelSub=jQuery("#panel-sub"),mobile.arrPanelData=jQuery(".panel-data"),mobile.arrDataTagButtons=jQuery(".compare-tag"),mobile.arrDataPopovers=jQuery(".data-popover"),mobile.arrPopoverCloseButtons=jQuery(".popover-close-button"),mobile.arrDataColumns=jQuery(".data-column"),mobile.companyAverages={percent_metal_pipe:.07,percent_old_pipe:.379,percent_gas_lost:.0229,leaks_per_1k:35.18},mobile.currentCompany=null,mobile.setPanelInfo=function(company,isUserSet){var arrCompareTags=$(".data-charts").find(".compare-tag");if(null===company)mobile.panelHead.empty(),mobile.panelSub.empty(),$(".data-charts").removeClass("show"),arrCompareTags.removeClass("above"),arrCompareTags.removeClass("below"),arrCompareTags.removeClass("average"),arrCompareTags.empty(),mobile.arrPanelData.eq(0).addClass("hidden");else{if(mobile.arrPanelData.eq(0).removeClass("hidden"),$(".data-charts").addClass("show"),mobile.panelHead.text(isUserSet?"You selected "+company.name:company.name),mobile.panelSub.text(company.office_city+", "+company.office_state),mobile.panelSub.show(),mobile.drawChart("#data-column1",company.pct_totalbaremetal),mobile.drawChart("#data-column2",company.pct_pre1970miles),mobile.drawChart("#data-column3",company.percent_lostgas),$(".metal-miles").remove(),arrCompareTags.removeClass("above"),arrCompareTags.removeClass("below"),arrCompareTags.removeClass("average"),arrCompareTags.empty(),company.hazleaks_per1000miles){var dataHTMLStr="<div class='metal-miles'>"+Math.round(10*company.hazleaks_per1000miles)/10+"</div>";$("#data-column4").prepend(dataHTMLStr),$("#data-column4").find(".data-decription").show(),$("#data-column4").find(".compare-tag").show()}else $("#data-column4").find(".data-decription").hide(),$("#data-column4").find(".compare-tag").hide();mobile.compareAverages(company.pct_totalbaremetal,mobile.companyAverages.percent_metal_pipe,1),mobile.compareAverages(company.pct_pre1970miles,mobile.companyAverages.percent_old_pipe,2),mobile.compareAverages(company.percent_lostgas,mobile.companyAverages.percent_gas_lost,3),mobile.compareAverages(company.totalbaremetal_miles,mobile.companyAverages.leaks_per_1k,4)}},mobile.drawChart=function(el,prop){$el=$(el),$el.find("svg").remove();var textPosition,w=.75*$el.width(),radius=w/2,barWidth=10;textPosition=$(window).width()>600?"translate(-20, 5)":$(window).width()>=1e3?"translate(-25, 5)":"translate(-15, 5)";var data=[Math.round(100*prop)/100,Math.round(100*(1-prop))/100],arc=d3.svg.arc().outerRadius(radius).innerRadius(radius-barWidth),pie=d3.layout.pie().sort(null).value(function(d){return d}),svg=d3.select(el).insert("svg",".data-decription").attr("width",w).attr("height",w).append("g").attr("transform","translate("+w/2+","+w/2+")"),g=(svg.append("circle").attr("r",radius-barWidth).attr("cx",0).attr("cy",0).style("fill","#E6E6E6"),svg.selectAll(".arc").data(pie(data)).enter().append("g").attr("class","arc"));g.append("path").attr("d",arc).style("fill",function(d,i){return 0===i?"#1B9CFA":"rgba(255, 255, 255, 0)"});svg.append("text").data(data).text(function(d){return Math.round(100*d)+"%"}).attr("transform",textPosition).attr("class","chart-percent-text")},mobile.compareAverages=function(companyData,averageData,columnNumber){var column="#data-column"+columnNumber,tag=$(column).find(".compare-tag");companyData>averageData?(tag.text("Above Average"),tag.addClass("above")):companyData==averageData?(tag.text("Average"),tag.addClass("average")):averageData>companyData&&(tag.text("Below Average"),tag.addClass("below"))},mobile.listen=function(){mobile.arrDataTagButtons.on("click",function(){var $this=$(this),dataIndex=mobile.arrDataTagButtons.index($this);mobile.arrDataPopovers.eq(dataIndex).fadeIn(250)}),mobile.arrPopoverCloseButtons.on("click",function(){var $this=$(this),dataIndex=mobile.arrPopoverCloseButtons.index($this);mobile.arrDataPopovers.eq(dataIndex).fadeOut(250)}),$(window).on("resize",function(){mobile.setDataColumnSize(),mobile.setPanelInfo(mobile.currentCompany)})},mobile.setDataColumnSize=function(){var windowWidth=$(window).width(),width=mobile.arrDataColumns.width();mobile.arrDataColumns.height(windowWidth>640?width:windowWidth>475&&640>=windowWidth?190:160)},$(document).ready(function(){var blnIframeEmbed=window!=window.parent;mobile.listen(),blnIframeEmbed&&($(".mobile-back-bar").empty().css("height","2em"),$(".mobile-footer").hide(),$(".mobile-company-info-box").css("font-size","2em")),mobile.setDataColumnSize(),mobile.arrPanelData.eq(0).addClass("hidden")}),function(){var searchApp=angular.module("gasSearch",[]);searchApp.controller("SearchController",function($http,$scope,$filter){$scope.companies=[],$http.get("js/companies.json").then(function(data){$scope.companies=data.data,window.setTimeout(function(){$(".preloader-mobile").eq(0).fadeOut(500)},1e3)}),this.blur=function(){$scope.filterTerm=""},this.setComanyFocus=function(company){mobile.currentCompany=company,mobile.setPanelInfo(company),$scope.isFormOpen=!1,$scope.filterTerm="",jQuery(window).on("resetSearch",function(){$scope.filterTerm="",mobile.searchCont.find("input").val("")})},this.clear=function(){$scope.filterTerm="",mobile.setPanelInfo(null)},this.mobileSearch=function(){mobile.arrPanelData.eq(0).addClass("hidden");var filteredArray=$filter("filter")($scope.companies,$scope.filterTerm,!1);0===filteredArray.length?$(".mobile-company-info-box").show():$(".mobile-company-info-box").hide(),""!==$scope.filterTerm?(mobile.currentCompany=null,$scope.isFormOpen=!0):$scope.isFormOpen=!1}})}();
//# sourceMappingURL=mobile.min.map